extends base

block content
    table.fatitem(border="0")
        tr#_id.athing
            td.title(align="right" valign="top")
                span.rank
            td.votelinks(valign="top")
                center
                    a#up_postId.nosee(onclick='return vote(event, this, "up")' href="vote?id=" + post._id)
                        .votearrow(title="upvote")
            td.title
                if post.__type === 'Url'
                    - post.url = (post.url.indexOf('://') === -1) ? '//' + post.url : post.url;
                    a.storylink(href=post.url) &nbsp#{post.title}&nbsp
                    span.sitebit.comhead
                        | (
                        a(href="from?site=" + post.tld)
                            span.sitestr #{post.tld}
                        | )
                else
                    a.storylink(href="item?id=" + post._id) &nbsp#{post.title}&nbsp
        tr
            td(colspan="2")
            td.subtext
                span#score__id.score #{post.totalLikes} points&nbsp
                | by&nbsp
                a.hnuser(href="user?id=" + post.owner.username) #{post.owner.username}
                span.age
                    - function timeSince(date) {
                    - let seconds = Math.floor((new Date() - date) / 1000);
                    - let interval = Math.floor(seconds / 31536000);
                    - if (interval >= 1) return interval + " years ago";
                    - interval = Math.floor(seconds / 2592000);
                    - if (interval >= 1) return interval + " months ago";
                    - interval = Math.floor(seconds / 86400);
                    - if (interval >= 1) return interval + " days ago";
                    - interval = Math.floor(seconds / 3600);
                    - if (interval >= 1) return interval + " hours ago";
                    - interval = Math.floor(seconds / 60);
                    - if (interval >= 1) return interval + " minutes ago";
                    - return Math.floor(seconds) + " seconds ago";
                    - }
                    | &nbsp
                    a(href="item?id=" + _id) #{timeSince(post.createdAt)}
                span#unv_post._id
                | &nbsp|&nbsp
                // TODO
                a(href="https://www.google.com/search?q=") web
                | &nbsp|&nbsp
                a(href="fave?id=" + post._id) favorite
                | &nbsp|&nbsp
                if post.totalComments === 0
                    a(href="item?id=" + post._id) discuss
                else if post.totalComments === 1
                    a(href="item?id=" + post._id) #{post.totalComments} comment
                else
                    a(href="item?id=" + post._id) #{post.totalComments} comments
        tr(style="height:10px")
        tr
            td(colspan="2")
            td
                form(method="post" action="comment")
                    input(type="hidden" name="post" value=_id)
                    textarea(name="text" rows="6" cols="60")
                    br
                    br
                    input(type="submit" value="Add comment")
    br
    br
    table.comment-tree(border="0")
        tr#16847762.athing.comtr
            td
                table(border="0")
                    tr
                        td.ind
                            img(src="s.gif" height="1" width="0")
                        td.default
                            div(style="margin-top:2px; margin-bottom:-10px;")
                                span.comhead
                                    span#score_16847762.score 1 point
                                    |  by
                                    a.hnuser(href="user?id=sferadev")
                                        font(color="#3c963c") sferadev
                                    span.age
                                        a(href="item?id=16847762") 0 minutes ago
                                    span#unv_16847762
                                    span.par
                                    |  |
                                    a(href="edit?id=16847762") edit
                                    |  |
                                    a(href="delete-confirm?id=16847762&goto=item%3Fid%3D16791313") delete
                                    a.togg(n="1" href="javascript:void(0)" onclick="return toggle(event, 16847762)")
                                    span.storyon
                            br
                            .comment
                                span.c00
                                    | It's really useful
                                    span
                                    .reply
                                        p
                                            font(size="1")
    br